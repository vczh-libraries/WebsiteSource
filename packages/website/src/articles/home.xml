<article index="true">
    <topic>
        <title>Welcome to Gaclib!</title>
        <p>
            Gaclib is a GPU accelerated C++ User Interface library.
            You can find it at <a href="https://github.com/vczh-libraries/Release">github</a>.
            This library provide many useful features.
            If you don't need all features,
            you can just use a subset of released C++ files to reduce the size of the executable.
        </p>
        <p>
            More and more developers are using this library to create their applications!
            You could check out <a href="http://www.majorav.com">majorav.com</a>,
            which is a very impressive example.
            Scroll to the end to see screenshots!
        </p>
        <topic>
            <title>GacUI!</title>
            <topic>
                <title>Rich controls and flexible layout</title>
                <p>List controls:</p>
                <p><img src="/resources/home/demo_AB.png"/></p>
                <p>Ribbon and editor controls:</p>
                <p><img src="/resources/home/demo_DER.png"/></p>
            </topic>
            <topic>
                <title>Easy syntax</title>
                <p>
                    <program language="Xml"><code><![CDATA[
<Instance ref.Class="helloworld::MainWindow">
    <Window Text="Hello, world!">
        <Label Text="Welcome to GacUI Library!"/>
    </Window>
</Instance>
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Localization</title>
                <p>Resource: stores strings and their translations</p>
                <p>
                    <program language="Xml"><code><![CDATA[
<LocalizedStrings ref.Class="helloworld::StringResource" DefaultLocale="en-US">
    <Strings Locales="en-US">
        <String Name="Title" Text="Hello, world!"/>
        <String Name="Button" Text="Good morning!"/>
    </Strings>
    <Strings Locales="zh-CN">
        <String Name="Title" Text="你好，世界！"/>
        <String Name="Button" Text="早上好！"/>
    </Strings>
</LocalizedStrings>
                    ]]></code></program>
                </p>
                <p>UI: use strings from resource</p>
                <p>
                    <program language="Xml"><code><![CDATA[
<Instance ref.Class="helloworld::MainWindow">
    <ref.LocalizedStrings Name="Strings" helloworld="demo::StringResource" Default="true"/>
    <Window Text-str="Title()">
        <Button Text-str="Button()">
    </Window>
</Instance>
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Styling</title>
                <p>Styles: set properties by selector</p>
                <p>
                    <program language="Xml"><code><![CDATA[
<Styles>
    <Style ref.Path="//Cell/Button" Font="fontFamily:'Segoe UI' size: 24 antialias:true">
        <att.BoundsComposition-set AlignmentToParent="left:0 top:0 right:0 bottom:0"/>
    </Style>
</Styles>
                    ]]></code></program>
                </p>
                <p>UI: applies styles on multiple controls</p>
                <p>
                    <program language="Xml"><code><![CDATA[
<Instance ref.Class="helloworld::MainWindow">
    <Window Text="Hello, world!">
        <Table CellPadding="5" AlignmentToParent="left:0 top:0 right:0 bottom:0">
            <att.Rows>
                <CellOption>composeType:Percentage percentage:1.0</CellOption>
                <CellOption>composeType:MinSize</CellOption>
            </att.Rows>
            <att.Columns>
                <CellOption>composeType:Percentage percentage:1.0</CellOption>
                <CellOption>composeType:MinSize</CellOption>
                <CellOption>composeType:MinSize</CellOption>
            </att.Columns>

            <Cell Site="row:1 column:1 columnSpan:2">
                <Button Text="OK"/>
            </Cell>

            <Cell Site="row:1 column:2 columnSpan:2">
                <Button Text="Cancel"/>
            </Cell>
        </Table>
    </Window>
</Instance>
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>MVVM and Data binding</title>
                <p>Script: defines the interface for view model</p>
                <p>
                    <program language="Xml"><code><![CDATA[
module script;

namespace helloworld
{
    interface IViewModel
    {
        prop Title : string {GetTitle, SetTitle : TitleChanged}
        func Submit() : void;
    }
}
                    ]]></code></program>
                </p>
                <p>UI: binds view model to text box and button</p>
                <p>
                    <program language="Xml"><code><![CDATA[
<Instance ref.Class="helloworld::MainWindow">
    <ref.Parameter Name="ViewModel" Class="helloworld::IViewModel"/>
    <Window ref.Name="self" Text="Hello, world!">
        <Table CellPadding="5" AlignmentToParent="left:0 top:0 right:0 bottom:0">
            <att.Rows>
                <CellOption>composeType:MinSize</CellOption>
                <CellOption>composeType:Percentage percentage:1.0</CellOption>
                <CellOption>composeType:MinSize</CellOption>
            </att.Rows>
            <att.Columns>
                <CellOption>composeType:MinSize</CellOption>
                <CellOption>composeType:Percentage percentage:1.0</CellOption>
            </att.Columns>

            <Cell Site="row:0 column:0">
                <SolidLabel Text="Title: " Font-bind="self.Font"/>
            </Cell>
            <Cell Site="row:0 column:1">
                <SinglelineTextBox Text-bind="ViewModel.Title">
                    <att.BoundsComposition-set
                        AlignmentToParent="left:0 top:0 right:0 bottom:0"
                        PreferredMinSize="x:0 y:24"/>
                </SinglelineTextBox>
            </Cell>
            <Cell Site="row:2 column:0 columnSpan:2">
                <Button Text="Submit" ev.Clicked-eval="ViewModel.Submit()">
                    <att.BoundsComposition-set AlignmentToParent="left:-1 top:0 right:0 bottom:0"/>
                </Button>
            </Cell>
        </Table>
    </Window>
</Instance>
                    ]]></code></program>
                </p>
                <p>Application: implement the view model</p>
                <p>
                    <program language="Xml"><code><![CDATA[
class ViewModel : public Object, public virtual helloworld::IViewModel
{
private:
    WString title;

public:

    WString GetTitle()override
    {
        return title;
    }

    void SetTitle(const WString& value)override
    {
        title = value;
        TitleChanged();
    }

    void Submit()override
    {
        // do something
    }
};

void GuiMain()
{
    {
        FileStream fileStream(L"MVVM.bin", FileStream::ReadOnly);
        GetResourceManager()->LoadResourceOrPending(fileStream);
    }
    auto viewModel = MakePtr<ViewModel>();
    auto window = new helloworld::MainWindow(viewModel);
    window->MoveToScreenCenter();
    GetApplication()->Run(window);
    delete window;
}
                    ]]></code></program>
                </p>
            </topic>
        </topic>
        <topic>
            <title>Data processing</title>
            <topic>
                <title>Containers</title>
                <p>
                    <program language="C++"><code><![CDATA[
Group<vint, WString> xs;
xs.Add(1, L"C++");
xs.Add(1, L"C#");
xs.Add(1, L"TypeScript");
xs.Add(2, L"Java");
const List<WString>& ones = xs.Get[1];
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Rich collection operations</title>
                <p>
                    <program language="C++"><code><![CDATA[
vint numbers[] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
vint sumOfSquares = From(numbers)
    .Select([](vint i) { return i * i; })
    .Aggregate([](vint a, vint b) { return a + b; });
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Files and streams</title>
                <p>
                    <program language="C++"><code><![CDATA[
Folder folder(L"C:/MyProjects/");
List<File> files;
folder.GetFiles(files);

WString fileNames = GenerateToStream([&](const TextWriter& writer)
{
    FOREACH(File, file, files)
    {
        writer.WriteLine(file.GetFilePath().GetName());
    }
});
File(L"C:/MyProjects/index.txt")
    .WriteAllText(fileNames, false, BomEncoder::Utf8);
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Http client</title>
                <p>
                    <program language="C++"><code><![CDATA[
HttpRequest request;
request.SetHost(L"http://gaclib.net");

HttpResponse response;
HttpQuery(request, response);

Console::WriteLine(itow(response.statusCode));
Console::WriteLine(response.GetBodyUtf8());
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Threading and synchronozation</title>
                <p>
                    <program language="C++"><code><![CDATA[
EventObject event;
event.CreateAutoUnsignal(false);

Thread::CreateAndStart([&]()
{
    DoSomething();
    event.Signal();
});

event.Wait();
                    ]]></code></program>
                </p>
            </topic>
        </topic>
        <topic>
            <title>String processing</title>
            <topic>
                <title>Regular expression</title>
                <p>
                    <program language="C++"><code><![CDATA[
Regex regex(L"^(<name>\w+):(<adj>\w+)");
Ptr<RegexMatch> match = regex.Match(L"GacUI:great");
Console::WriteLine(
    L"Hey, " +
    match->Groups()[L"name"][0].Value() +
    L" is " +
    match->Groups()[L"adj"][0].Value() +
    L"!"
);
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>GLR parser generation</title>
                <p>Grammar:</p>
                <p>
                    <program language="C++"><code><![CDATA[
include:<VlppParser.h>
namespace:calculator
reflection:calculator
classPrefix:Cal
classRoot:Expression
guard:CALCULATOR_PARSER
parser:Parse(Exp)
filePrefix:Calculator
file:Ast(_Ast)
file:Parser(_Parser)
ambiguity:disabled
serialization:enabled
grammar:

class Expression
{
}

class NumberExpression : Expression
{
    token value;
}

class BinaryExpression : Expression
{
    enum BinaryOperator
    {
        Add,
        Sub,
        Mul,
        Div,
    }

    Expression firstOperand;
    Expression secondOperand;
    BinaryOperator binaryOperator;
}

class FunctionExpression : Expression
{
    token functionName;
    Expression[] arguments;
}

token NAME = "[a-zA-Z_]/w*";
token NUMBER = "/d+(./d+)?";
token ADD = "/+";
token SUB = "-";
token MUL = "/*";
token DIV = "//";
token LEFT = "/(";
token RIGHT = "/)";
token COMMA = ",";
discardtoken SPACE = "/s+";

rule NumberExpression Number
        = NUMBER : value as NumberExpression
        ;
rule FunctionExpression Call
        = NAME : functionName "(" [ Exp : arguments { "," Exp : arguments } ] ")" as FunctionExpression
        ;
rule Expression Factor
        = !Number | !Call
        = "(" !Exp ")"
        ;
rule Expression Term
        = !Factor
        = Term : firstOperand "*" Factor : secondOperand as BinaryExpression with { binaryOperator = "Mul" }
        = Term : firstOperand "/" Factor : secondOperand as BinaryExpression with { binaryOperator = "Div" }
        ;
rule Expression Exp
        = !Term
        = Exp : firstOperand "+" Term : secondOperand as BinaryExpression with { binaryOperator = "Add" }
        = Exp : firstOperand "-" Term : secondOperand as BinaryExpression with { binaryOperator = "Sub" }
        ;
                    ]]></code></program>
                </p>
                <p>And what you get from generated C++ code:</p>
                <p>
                    <program language="C++"><code><![CDATA[
auto table = CalLoadTable();
Ptr<CalExpression> expr = CalParse(L"max(1, 2) * 3 - 4", table);
                    ]]></code></program>
                </p>
            </topic>
        </topic>
        <topic>
            <title>C++ reflection and scripting</title>
            <topic>
                <title>Easy registration</title>
                <p>
                    <program language="C++"><code><![CDATA[
namespace myapi
{
    class App : public Object, public Description<App>
    {
    public:
        void Print(const WString& text) { Console::WriteLine(text); }
        WString Get() { return Console::Read(); }
    };
}

using namespace myapi;

#define TYPE_LIST(F) F(myapi::App)

BEGIN_TYPE_INFO_NAMESPACE

    TYPE_LIST(DECL_TYPE_INFO)
    TYPE_LIST(IMPL_CPP_TYPE_INFO)

    BEGIN_CLASS_MEMBER(App)
        CLASS_MEMBER_CONSTRUCTOR(Ptr<App>(), NO_PARAMETER)
        CLASS_MEMBER_METHOD(Print, {L"text"})
        CLASS_MEMBER_METHOD(Get, NO_PARAMETER)
    END_CLASS_MEMBER(App)

    class MyTypeLoader : public Object, public ITypeLoader
    {
    public:
        void Load(ITypeManager* manager)override
        {
            TYPE_LIST(ADD_TYPE_INFO)
        }
        
        void Unload(ITypeManager* manager)override
        {
        }
    };

END_TYPE_INFO_NAMESPACE
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Dynamic invoking</title>
                <p>
                    <program language="C++"><code><![CDATA[
LoadPredefinedTypes();

auto tm = GetGlobalTypeManager();
tm->AddTypeLoader(new MyTypeLoader);
tm->Load();

auto td = tm->GetTypeDescriptor(L"myapi::App");
auto ctor = td->GetConstructorGroup()->GetMethod(0);
auto print = td->GetMethodGroupByName(L"Print");

Value app = ctor->Invoke(Value(), Value_xs());

arguments.Add(BoxValue<WString>(L"Hello, world!"));
print->Invoke(app, (Value_xs(), WString(L"Hello, world!")));

ResetGlobalTypeManager();
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>Scripting and native code interoperability</title>
                <p>
                    <program language="Workflow"><code><![CDATA[
module myscript;
using myapp::*;

class MyScript
{
    new()
    {
    }

    func Main() : void
    {
        var app = new App^();
        var name = app.Get();
        app.Print($"Hello, $(name)!");
    }
}
                    ]]></code></program>
                </p>
            </topic>
            <topic>
                <title>C++ code generation</title>
                <p>Compile the script and generate C++ code, call it in C++!</p>
                <p>
                    <program language="C++"><code><![CDATA[
#include "MyScript.h"

int main()
{
    MakePtr<MyScript>()->Main();
}
                    ]]></code></program>
                </p>
            </topic>
        </topic>
    </topic>
</article>