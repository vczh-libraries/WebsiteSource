<article index="true">
    <topic>
        <title>Handling Unexpected Inputs</title>
        <p>
            Workflow offers built-in strategy for handling unexpected inputs.
        </p>
        <topic>
            <title>$switch()</title>
            <p>
                <b>$switch()</b> ignores unpected inputs and continues to execute code after <b>$switch</b>.
                <program><code><![CDATA[
                    module sampleModule;

                    using system::*;

                    class MySM : StateMachine
                    {
                        prop Output: string = "" {not observe}

                        func Append(text: string): void
                        {
                            Output = $"$(Output)$(text); ";
                        }

                        $state_machine
                        {
                            $state_input A(name: string);
                            $state_input B(name: string);
                            $state_input C(name: string);

                            $state WaitForName()
                            {
                                $switch ()
                                {
                                case A(name):
                                    {
                                        Append($"A($(name))");
                                    }
                                case B(name):
                                    {
                                        Append($"B($(name))");
                                    }
                                }
                                Append("Finishes WaitForName()");
                            }

                            $state default()
                            {
                                $push_state WaitForName();
                                Append("Finishes default()");
                            }
                        }
                    }

                    func main(): string
                    {
                        var sm = new MySM^();
                        try
                        {
                            sm.C("John");
                        }
                        catch (ex)
                        {
                            sm.Append(ex.Message);
                        }
                        return sm.Output;
                    }
                ]]></code></program>
                The <b>main</b> function returns <b>"Finishes WaitForName(); Finishes default(); "</b>.
                When <b>C("John")</b> is called,
                <b>$switch</b> found this is an unexpected input,
                it continues to run code after <b>$switch</b>.
            </p>
        </topic>
        <topic>
            <title>$switch(raise)</title>
            <p>
                <b>$switch()</b> throws an exception when unpected inputs are called.
                <program><code><![CDATA[
                    module sampleModule;

                    using system::*;

                    class MySM : StateMachine
                    {
                        prop Output: string = "" {not observe}

                        func Append(text: string): void
                        {
                            Output = $"$(Output)$(text); ";
                        }

                        $state_machine
                        {
                            $state_input A(name: string);
                            $state_input B(name: string);
                            $state_input C(name: string);

                            $state WaitForName()
                            {
                                $switch (raise)
                                {
                                case A(name):
                                    {
                                        Append($"A($(name))");
                                    }
                                case B(name):
                                    {
                                        Append($"B($(name))");
                                    }
                                }
                                Append("Finishes WaitForName()");
                            }

                            $state default()
                            {
                                $push_state WaitForName();
                                Append("Finishes default()");
                            }
                        }
                    }

                    func main(): string
                    {
                        var sm = new MySM^();
                        try
                        {
                            sm.C("John");
                        }
                        catch (ex)
                        {
                            sm.Append(ex.Message);
                        }
                        try
                        {
                            sm.A("John");
                        }
                        catch (ex)
                        {
                            sm.Append(ex.Message);
                        }
                        return sm.Output;
                    }
                ]]></code></program>
                The <b>main</b> function returns <b>"Method "C" of class "MySM" cannot be called at this moment.; The state machine has been stopped.; "</b>.
                When <b>C("John")</b> is called,
                <b>$switch</b> found this is an unexpected input,
                it throws an exception,
                and the state machine is stopped.
            </p>
        </topic>
        <topic>
            <title>$switch(return)</title>
            <p>
                <b>$switch()</b> stops the current state when unpected inputs are called and continues.
                <program><code><![CDATA[
                    module sampleModule;

                    using system::*;

                    class MySM : StateMachine
                    {
                        prop Output: string = "" {not observe}

                        func Append(text: string): void
                        {
                            Output = $"$(Output)$(text); ";
                        }

                        $state_machine
                        {
                            $state_input A(name: string);
                            $state_input B(name: string);
                            $state_input C(name: string);

                            $state WaitForName()
                            {
                                $switch (return)
                                {
                                case A(name):
                                    {
                                        Append($"A($(name))");
                                    }
                                case B(name):
                                    {
                                        Append($"B($(name))");
                                    }
                                }
                                Append("Finishes WaitForName()");
                            }

                            $state default()
                            {
                                $push_state WaitForName();
                                Append("Finishes default()");
                            }
                        }
                    }

                    func main(): string
                    {
                        var sm = new MySM^();
                        try
                        {
                            sm.C("John");
                        }
                        catch (ex)
                        {
                            sm.Append(ex.Message);
                        }
                        return sm.Output;
                    }
                ]]></code></program>
                The <b>main</b> function returns <b>"Finishes default(); "</b>.
                When <b>C("John")</b> is called,
                <b>$switch</b> found this is an unexpected input,
                it stops <b>$state WaitForName()</b>,
                and continues to run the remainings.
            </p>
        </topic>
        <topic>
            <title>$switch(continue)</title>
        </topic>
        <topic>
            <title>$switch(continue, return)</title>
        </topic>
    </topic>
</article>